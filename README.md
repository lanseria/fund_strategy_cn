# 基于双均线交叉的基金择时策略

本项目实现并回测了一个经典的量化交易策略——**双移动平均线（DMA）交叉策略**，并将其应用于一只具体的基金。项目的目标是验证该择时策略是否能够跑赢其基准指数的简单“买入并持有”策略。

整个流程，从数据获取到绩效评估，均使用 Python 的 `backtrader`、`akshare` 和 `quantstats` 库实现自动化。

## 策略逻辑

双均线交叉策略的核心思想，是通过观察两条不同周期的移动平均线（Moving Average, MA）之间的关系来判断趋势变化：

1.  **快速移动平均线 (快线)**: 一条短期均线（例如20日），它对近期的价格变化反应更灵敏。
2.  **慢速移动平均线 (慢线)**: 一条长期均线（例如60日），它代表了更稳定的长期趋势。

交易信号的产生规则如下：

-   **买入信号 (金叉 - Golden Cross)**: 当**快线**从下方**上穿**慢线时，表明近期市场的上涨动能强于长期趋势。这被视为一个看涨信号，策略将**进入市场（买入基金）**。

-   **卖出信号 (死叉 - Death Cross)**: 当**快线**从上方**下穿**慢线时，表明近期的上涨趋势可能正在减弱或反转。这被视为一个看跌信号，策略将**退出市场（卖出全部持仓）**，并空仓等待。

该策略旨在抓住市场主要的上涨波段，并通过在下跌趋势期间保持空仓来规避大幅回撤。

## 如何使用本项目

### 1. 环境准备

请确保您已安装 Python，然后通过以下命令安装所需的库：

```bash
pip install backtrader akshare quantstats pandas
```

### 2. 参数配置

所有关键参数都集中在脚本（`fund_strategy_cn.py`）的顶部，方便您修改：

```python
# --- 策略与回测配置 ---
FUND_SYMBOL = '001632'          # 需要回测的基金代码 (例如：天弘沪深300指数增强A)
BENCHMARK_SYMBOL = 'sh000300'   # 业绩比较基准的指数代码 (例如：沪深300指数)
START_DATE = '20180101'         # 回测开始日期
END_DATE = '20231231'           # 回测结束日期
INITIAL_CASH = 100000.0         # 初始资金
COMMISSION_RATE = 0.0015        # 买卖手续费率 (例如: 0.15%)

# --- 策略参数 ---
FAST_MA_PERIOD = 20             # 快速移动平均线的周期
SLOW_MA_PERIOD = 60             # 慢速移动平均线的周期
```

您可以修改这些值来回测不同的基金、时间周期或均线组合。

### 3. 运行回测

在您的终端中执行以下命令：

```bash
python fund_strategy_cn.py
```

### 4. 解读输出

脚本运行后会产生两种主要输出：

**a) 控制台日志:**
控制台会打印详细的交易日志，显示每一次买卖信号的产生和执行细节，包括日期、份额、价格和费用。

```
...
2020-04-15: 金叉信号，准备买入基金 001632

--- 交易执行 ---
日期: 2020-04-16
操作: 买入 (BUY)
基金: 001632
成交份额: 45550.91
成交价格: 1.8899
交易金额: 86086.08
手续费: 129.13
-----------------
...
```

**b) 绩效分析报告 (HTML):**
一个名为 `strategy_report_{基金代码}.html` (例如: `strategy_report_001632.html`) 的交互式HTML报告会自动生成在同一目录下。

这份由 `quantstats` 生成的报告是评估策略表现的关键。它提供了：
-   **累计收益率曲线图**，直观对比策略与基准的表现。
-   关键绩效指标，如 **年化收益率 (CAGR)**、**最大回撤** 和 **夏普比率**。
-   更深入的分析指标，如 **阿尔法 (Alpha)** 和 **贝塔 (Beta)**，用于衡量策略相对于市场的真实超额收益能力。

请使用浏览器打开此文件查看完整的分析结果。

## 项目结构

-   **`fund_strategy_cn.py`**: 包含整个工作流程的核心Python脚本。
    -   **数据获取**: 使用 `akshare` 获取基金和基准数据。
    -   **策略类 (`DualMACrossoverStrategy`)**: 使用 `backtrader` 实现交易逻辑。
    -   **回测引擎**: 使用 `backtrader` 配置并运行模拟交易。
    -   **绩效报告**: 使用 `quantstats` 生成最终的分析报告。
-   **`README.md`**: 本文件，用于解释整个项目。

## 总结

本项目是一个完整的端到端实例，展示了如何实现、回测并严格评估一个量化交易策略。通过将策略表现与一个合适的基准进行比较，我们可以对其有效性做出更科学、更客观的判断。